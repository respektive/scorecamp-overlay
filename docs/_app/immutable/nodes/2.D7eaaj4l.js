import{a as Q,n as U,c as ce,o as fe}from"../chunks/scheduler.CbAa4uEG.js";import{S as R,i as q,e as v,s as j,t as C,c as b,a as S,d as h,f as $,b as P,o as f,p as x,g as B,h as c,j as I,u as z,v as W,w as M,n as D,q as X,l as N,m as Y,x as K,k as ee,y as de}from"../chunks/index.8LiQRpMr.js";import{d as he,w as te}from"../chunks/index.Cxq2KWkB.js";function re(s){return(s==null?void 0:s.length)!==void 0?s:Array.from(s)}function pe(s){if(s.__esModule)return s;var e=s.default;if(typeof e=="function"){var r=function t(){return this instanceof t?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};r.prototype=e.prototype}else r={};return Object.defineProperty(r,"__esModule",{value:!0}),Object.keys(s).forEach(function(t){var i=Object.getOwnPropertyDescriptor(s,t);Object.defineProperty(r,t,i.get?i:{enumerable:!0,get:function(){return s[t]}})}),r}var y={};const ge={},me=Object.freeze(Object.defineProperty({__proto__:null,default:ge},Symbol.toStringTag,{value:"Module"})),_e=pe(me);let se=_e;class ve{readFile(e,r){return se.readFileSync(e,r).toString()}writeFile(e,r){se.writeFile(r,e,function(t){if(t)throw t;console.log("File saved: "+r)})}}var be=new ve;class ye{trimPropertyName(e){return e.replace(/\s/g,"")}getValueFormatByType(e){return e===void 0||e===""?"":isNaN(e)?e==="true"||e==="false"?JSON.parse(e.toLowerCase()):String(e):Number(e)}hasContent(e){if(e.length>0){for(let r=0;r<e.length;r++)if(e[r])return!0}return!1}}var Se=new ye;class we{validateJson(e){try{JSON.parse(e)}catch(r){throw Error(`Parsed csv has generated an invalid json!!!
`+r)}}}var Ee=new we;let ne=be,H=Se,Fe=Ee;const ke=/\r?\n/,Je=";";class Te{formatValueByType(e){return this.printValueFormatByType=e,this}supportQuotedField(e){return this.isSupportQuotedField=e,this}fieldDelimiter(e){return this.delimiter=e,this}indexHeader(e){if(isNaN(e))throw new Error("The index Header must be a Number!");return this.indexHeader=e,this}parseSubArray(e="*",r=","){this.parseSubArrayDelimiter=e,this.parseSubArraySeparator=r}encoding(e){return this.encoding=e,this}generateJsonFileFromCsv(e,r){let t=this.getJsonFromCsvStringified(e);ne.writeFile(t,r)}getJsonFromCsvStringified(e){let r=this.getJsonFromCsv(e),t=JSON.stringify(r,void 0,1);return Fe.validateJson(t),t}getJsonFromCsv(e){let r=ne.readFile(e,this.encoding);return this.csvToJson(r)}csvStringToJson(e){return this.csvToJson(e)}csvToJson(e){this.validateInputConfig();let r=e.split(ke),t=this.getFieldDelimiter(),i=this.getIndexHeader(),a;for(this.isSupportQuotedField?a=this.split(r[i]):a=r[i].split(t);!H.hasContent(a)&&i<=r.length;)i=i+1,a=r[i].split(t);let n=[];for(let o=i+1;o<r.length;o++){let l;this.isSupportQuotedField?l=this.split(r[o]):l=r[o].split(t),H.hasContent(l)&&n.push(this.buildJsonResult(a,l))}return n}getFieldDelimiter(){return this.delimiter?this.delimiter:Je}getIndexHeader(){return this.indexHeader!==null&&!isNaN(this.indexHeader)?this.indexHeader:0}buildJsonResult(e,r){let t={};for(let i=0;i<e.length;i++){let a=H.trimPropertyName(e[i]),n=r[i];this.isParseSubArray(n)&&(n=this.buildJsonSubArray(n)),this.printValueFormatByType&&!Array.isArray(n)&&(n=H.getValueFormatByType(r[i])),t[a]=n}return t}buildJsonSubArray(e){let r=e.substring(e.indexOf(this.parseSubArrayDelimiter)+1,e.lastIndexOf(this.parseSubArrayDelimiter));if(r.trim(),e=r.split(this.parseSubArraySeparator),this.printValueFormatByType)for(let t=0;t<e.length;t++)e[t]=H.getValueFormatByType(e[t]);return e}isParseSubArray(e){return!!(this.parseSubArrayDelimiter&&e&&e.indexOf(this.parseSubArrayDelimiter)===0&&e.lastIndexOf(this.parseSubArrayDelimiter)===e.length-1)}validateInputConfig(){if(this.isSupportQuotedField){if(this.getFieldDelimiter()==='"')throw new Error('When SupportQuotedFields is enabled you cannot defined the field delimiter as quote -> ["]');if(this.parseSubArraySeparator==='"')throw new Error('When SupportQuotedFields is enabled you cannot defined the field parseSubArraySeparator as quote -> ["]');if(this.parseSubArrayDelimiter==='"')throw new Error('When SupportQuotedFields is enabled you cannot defined the field parseSubArrayDelimiter as quote -> ["]')}}hasQuotes(e){return e.includes('"')}split(e){if(e.length==0)return[];let r=this.getFieldDelimiter(),t=[""];if(this.hasQuotes(e)){let i=e.split(""),a=0,n=!1,o=!1;if(i.forEach((l,u,d)=>{if(o){t[a]+=l,o=!1;return}if(l!='"'&&l!=r)t[a]+=l;else if(l==r&&n)t[a]+=l;else if(l==r){a++,t[a]="";return}else d[u+1]==='"'?o=!0:n?n=!1:n=!0}),n)throw new Error("Row contains mismatched quotes!");return t}else return e.split(r)}}var Ae=new Te;let k=Ae;const O={utf8:"utf8",ucs2:"ucs2",utf16le:"utf16le",latin1:"latin1",ascii:"ascii",base64:"base64",hex:"hex"};y.formatValueByType=function(s=!0){return k.formatValueByType(s),this};y.supportQuotedField=function(s=!1){return k.supportQuotedField(s),this};y.fieldDelimiter=function(s){return k.fieldDelimiter(s),this};y.indexHeader=function(s){return k.indexHeader(s),this};y.parseSubArray=function(s,e){return k.parseSubArray(s,e),this};y.customEncoding=function(s){return k.encoding=s,this};y.utf8Encoding=function(){return k.encoding=O.utf8,this};y.ucs2Encoding=function(){return k.encoding=O.ucs2,this};y.utf16leEncoding=function(){return k.encoding=O.utf16le,this};y.latin1Encoding=function(){return k.encoding=O.latin1,this};y.asciiEncoding=function(){return k.encoding=O.ascii,this};y.base64Encoding=function(){return this.csvToJson=O.base64,this};y.hexEncoding=function(){return this.csvToJson=O.hex,this};y.generateJsonFileFromCsv=function(s,e){if(!s)throw new Error("inputFileName is not defined!!!");if(!e)throw new Error("outputFileName is not defined!!!");k.generateJsonFileFromCsv(s,e)};y.getJsonFromCsv=function(s){if(!s)throw new Error("inputFileName is not defined!!!");return k.getJsonFromCsv(s)};y.csvStringToJson=function(s){return k.csvStringToJson(s)};y.jsonToCsv=function(s,e){k.generateJsonFileFromCsv(s,e)};async function De(){const e=await(await fetch("https://docs.google.com/spreadsheets/d/1DVJcFkyHP3dRsJdaKjz2EwWTNBcJVrO1_Eg3A9r6Szc/export?format=csv&id=1DVJcFkyHP3dRsJdaKjz2EwWTNBcJVrO1_Eg3A9r6Szc&gid=0")).text();return y.indexHeader(1).fieldDelimiter(",").supportQuotedField(!0).formatValueByType(!0).csvStringToJson(e).map(a=>({username:a.Username,user_id:a.UserID,score_at_start:parseInt(a.ScoreatStart.replaceAll(",","")),current_score:parseInt(a.currentelim.replaceAll(",","")),gained_score:parseInt(a.currentelim.replaceAll(",",""))-parseInt(a.ScoreatStart.replaceAll(",",""))})).sort((a,n)=>n.gained_score-a.gained_score).map((a,n)=>({...a,rank:n+1}))}async function je({depends:s}){return s("data:rankings"),{rankings:await De()}}const Ke=Object.freeze(Object.defineProperty({__proto__:null,load:je},Symbol.toStringTag,{value:"Module"}));function Ce(s){if(typeof window>"u"){const{subscribe:a}=te(s);return{subscribe:a}}const e=te(window.location.href),r=history.pushState,t=history.replaceState,i=()=>e.set(window.location.href);return history.pushState=function(){r.apply(this,arguments),i()},history.replaceState=function(){t.apply(this,arguments),i()},window.addEventListener("popstate",i),window.addEventListener("hashchange",i),{subscribe:he(e,a=>new URL(a)).subscribe}}const $e=Ce();function Pe(s){let e,r,t,i,a,n=s[0].username+"",o,l,u,d,F,T=s[0].gained_score.toLocaleString("en-US")+"",p,g,w,A,m=s[0].rank+"",_;return{c(){e=v("div"),r=v("div"),t=j(),i=v("div"),a=v("p"),o=C(n),l=j(),u=v("hr"),d=j(),F=v("p"),p=C(T),g=j(),w=v("p"),A=C("#"),_=C(m),this.h()},l(J){e=b(J,"DIV",{class:!0});var E=S(e);r=b(E,"DIV",{id:!0,style:!0,class:!0}),S(r).forEach(h),t=$(E),i=b(E,"DIV",{class:!0});var V=S(i);a=b(V,"P",{id:!0,class:!0});var L=S(a);o=P(L,n),L.forEach(h),l=$(V),u=b(V,"HR",{class:!0}),d=$(V),F=b(V,"P",{id:!0,class:!0});var Z=S(F);p=P(Z,T),Z.forEach(h),V.forEach(h),g=$(E),w=b(E,"P",{id:!0,class:!0});var G=S(w);A=P(G,"#"),_=P(G,m),G.forEach(h),E.forEach(h),this.h()},h(){f(r,"id","avatar"),x(r,"background-image","url(https://a.ppy.sh/"+s[0].user_id+")"),f(r,"class","svelte-10b9ljp"),f(a,"id","username"),f(a,"class","svelte-10b9ljp"),f(u,"class","svelte-10b9ljp"),f(F,"id","gained"),f(F,"class","svelte-10b9ljp"),f(i,"class","stats svelte-10b9ljp"),f(w,"id","rank"),f(w,"class","svelte-10b9ljp"),f(e,"class","card svelte-10b9ljp")},m(J,E){B(J,e,E),c(e,r),c(e,t),c(e,i),c(i,a),c(a,o),c(i,l),c(i,u),c(i,d),c(i,F),c(F,p),c(e,g),c(e,w),c(w,A),c(w,_)},p(J,[E]){E&1&&x(r,"background-image","url(https://a.ppy.sh/"+J[0].user_id+")"),E&1&&n!==(n=J[0].username+"")&&I(o,n),E&1&&T!==(T=J[0].gained_score.toLocaleString("en-US")+"")&&I(p,T),E&1&&m!==(m=J[0].rank+"")&&I(_,m)},i:U,o:U,d(J){J&&h(e)}}}function Ne(s,e,r){let{user:t}=e;return s.$$set=i=>{"user"in i&&r(0,t=i.user)},[t]}class Ve extends R{constructor(e){super(),q(this,e,Ne,Pe,Q,{user:0})}}function Ie(s){let e,r,t=s[0].username+"",i,a,n,o=s[0].gained_score.toLocaleString("en-US")+"",l,u,d,F=s[1].toLocaleString("en-US")+"",T;return{c(){e=v("div"),r=v("p"),i=C(t),a=j(),n=v("p"),l=C(o),u=j(),d=v("span"),T=C(F),this.h()},l(p){e=b(p,"DIV",{class:!0});var g=S(e);r=b(g,"P",{id:!0,class:!0});var w=S(r);i=P(w,t),w.forEach(h),a=$(g),n=b(g,"P",{id:!0,class:!0});var A=S(n);l=P(A,o),u=$(A),d=b(A,"SPAN",{id:!0,class:!0});var m=S(d);T=P(m,F),m.forEach(h),A.forEach(h),g.forEach(h),this.h()},h(){f(r,"id","username"),f(r,"class","svelte-8qxyyi"),f(d,"id",s[1]>0?"positive":"negative"),f(d,"class","svelte-8qxyyi"),f(n,"id","score"),f(n,"class","svelte-8qxyyi"),f(e,"class","delta svelte-8qxyyi")},m(p,g){B(p,e,g),c(e,r),c(r,i),c(e,a),c(e,n),c(n,l),c(n,u),c(n,d),c(d,T)},p(p,[g]){g&1&&t!==(t=p[0].username+"")&&I(i,t),g&1&&o!==(o=p[0].gained_score.toLocaleString("en-US")+"")&&I(l,o)},i:U,o:U,d(p){p&&h(e)}}}function Oe(s,e,r){let{main_user:t}=e,{compare_user:i}=e,a=i.gained_score-t.gained_score;return s.$$set=n=>{"main_user"in n&&r(2,t=n.main_user),"compare_user"in n&&r(0,i=n.compare_user)},[i,a,t]}class ue extends R{constructor(e){super(),q(this,e,Oe,Ie,Q,{main_user:2,compare_user:0})}}function ie(s){let e,r;return e=new ue({props:{main_user:s[0],compare_user:s[1][s[0].rank-2]}}),{c(){z(e.$$.fragment)},l(t){W(e.$$.fragment,t)},m(t,i){M(e,t,i),r=!0},p(t,i){const a={};i&1&&(a.main_user=t[0]),i&3&&(a.compare_user=t[1][t[0].rank-2]),e.$set(a)},i(t){r||(D(e.$$.fragment,t),r=!0)},o(t){N(e.$$.fragment,t),r=!1},d(t){K(e,t)}}}function ae(s){let e,r;return e=new ue({props:{main_user:s[0],compare_user:s[1][s[0].rank]}}),{c(){z(e.$$.fragment)},l(t){W(e.$$.fragment,t)},m(t,i){M(e,t,i),r=!0},p(t,i){const a={};i&1&&(a.main_user=t[0]),i&3&&(a.compare_user=t[1][t[0].rank]),e.$set(a)},i(t){r||(D(e.$$.fragment,t),r=!0)},o(t){N(e.$$.fragment,t),r=!1},d(t){K(e,t)}}}function Ue(s){let e,r,t,i,a,n=s[0].rank>1&&ie(s);t=new Ve({props:{user:s[0]}});let o=s[1][s[0].rank]&&ae(s);return{c(){e=v("div"),n&&n.c(),r=j(),z(t.$$.fragment),i=j(),o&&o.c(),this.h()},l(l){e=b(l,"DIV",{class:!0});var u=S(e);n&&n.l(u),r=$(u),W(t.$$.fragment,u),i=$(u),o&&o.l(u),u.forEach(h),this.h()},h(){f(e,"class","container svelte-19u337d")},m(l,u){B(l,e,u),n&&n.m(e,null),c(e,r),M(t,e,null),c(e,i),o&&o.m(e,null),a=!0},p(l,[u]){l[0].rank>1?n?(n.p(l,u),u&1&&D(n,1)):(n=ie(l),n.c(),D(n,1),n.m(e,r)):n&&(X(),N(n,1,1,()=>{n=null}),Y());const d={};u&1&&(d.user=l[0]),t.$set(d),l[1][l[0].rank]?o?(o.p(l,u),u&3&&D(o,1)):(o=ae(l),o.c(),D(o,1),o.m(e,null)):o&&(X(),N(o,1,1,()=>{o=null}),Y())},i(l){a||(D(n),D(t.$$.fragment,l),D(o),a=!0)},o(l){N(n),N(t.$$.fragment,l),N(o),a=!1},d(l){l&&h(e),n&&n.d(),K(t),o&&o.d()}}}function Be(s,e,r){let{user:t}=e,{rankings:i}=e;return s.$$set=a=>{"user"in a&&r(0,t=a.user),"rankings"in a&&r(1,i=a.rankings)},[t,i]}class Le extends R{constructor(e){super(),q(this,e,Be,Ue,Q,{user:0,rankings:1})}}function le(s,e,r){const t=s.slice();return t[1]=e[r],t[6]=r,t}function He(s){let e,r=re(s[0]),t=[];for(let i=0;i<r.length;i+=1)t[i]=oe(le(s,r,i));return{c(){e=v("table");for(let i=0;i<t.length;i+=1)t[i].c();this.h()},l(i){e=b(i,"TABLE",{class:!0});var a=S(e);for(let n=0;n<t.length;n+=1)t[n].l(a);a.forEach(h),this.h()},h(){f(e,"class","svelte-glvni4")},m(i,a){B(i,e,a);for(let n=0;n<t.length;n+=1)t[n]&&t[n].m(e,null)},p(i,a){if(a&1){r=re(i[0]);let n;for(n=0;n<r.length;n+=1){const o=le(i,r,n);t[n]?t[n].p(o,a):(t[n]=oe(o),t[n].c(),t[n].m(e,null))}for(;n<t.length;n+=1)t[n].d(1);t.length=r.length}},i:U,o:U,d(i){i&&h(e),de(t,i)}}}function Qe(s){let e,r;return e=new Le({props:{user:s[1],rankings:s[0]}}),{c(){z(e.$$.fragment)},l(t){W(e.$$.fragment,t)},m(t,i){M(e,t,i),r=!0},p(t,i){const a={};i&2&&(a.user=t[1]),i&1&&(a.rankings=t[0]),e.$set(a)},i(t){r||(D(e.$$.fragment,t),r=!0)},o(t){N(e.$$.fragment,t),r=!1},d(t){K(e,t)}}}function oe(s){let e,r,t,i=s[6]+1+"",a,n,o,l,u=s[1].username+"",d,F,T,p,g=s[1].gained_score.toLocaleString()+"",w,A;return{c(){e=v("tr"),r=v("td"),t=C("#"),a=C(i),n=j(),o=v("td"),l=v("a"),d=C(u),T=j(),p=v("td"),w=C(g),A=j(),this.h()},l(m){e=b(m,"TR",{class:!0});var _=S(e);r=b(_,"TD",{class:!0});var J=S(r);t=P(J,"#"),a=P(J,i),J.forEach(h),n=$(_),o=b(_,"TD",{class:!0});var E=S(o);l=b(E,"A",{href:!0,class:!0});var V=S(l);d=P(V,u),V.forEach(h),E.forEach(h),T=$(_),p=b(_,"TD",{class:!0});var L=S(p);w=P(L,g),L.forEach(h),A=$(_),_.forEach(h),this.h()},h(){f(r,"class","rank svelte-glvni4"),f(l,"href",F="#"+s[1].username),f(l,"class","svelte-glvni4"),f(o,"class","user svelte-glvni4"),f(p,"class","score svelte-glvni4"),f(e,"class","svelte-glvni4")},m(m,_){B(m,e,_),c(e,r),c(r,t),c(r,a),c(e,n),c(e,o),c(o,l),c(l,d),c(e,T),c(e,p),c(p,w),c(e,A)},p(m,_){_&1&&u!==(u=m[1].username+"")&&I(d,u),_&1&&F!==(F="#"+m[1].username)&&f(l,"href",F),_&1&&g!==(g=m[1].gained_score.toLocaleString()+"")&&I(w,g)},d(m){m&&h(e)}}}function Re(s){let e,r,t,i;const a=[Qe,He],n=[];function o(l,u){return l[1]?0:1}return e=o(s),r=n[e]=a[e](s),{c(){r.c(),t=ee()},l(l){r.l(l),t=ee()},m(l,u){n[e].m(l,u),B(l,t,u),i=!0},p(l,[u]){let d=e;e=o(l),e===d?n[e].p(l,u):(X(),N(n[d],1,1,()=>{n[d]=null}),Y(),r=n[e],r?r.p(l,u):(r=n[e]=a[e](l),r.c()),D(r,1),r.m(t.parentNode,t))},i(l){i||(D(r),i=!0)},o(l){N(r),i=!1},d(l){l&&h(t),n[e].d(l)}}}function qe(s,e,r){let t,i,a,n;ce(s,$e,l=>r(4,n=l));let{data:o}=e;return fe(()=>{const l=setInterval(()=>{invalidate("data:rankings")},3e5);return()=>{clearInterval(l)}}),s.$$set=l=>{"data"in l&&r(2,o=l.data)},s.$$.update=()=>{s.$$.dirty&16&&r(3,t=n.hash.substring(1).toLowerCase()),s.$$.dirty&12&&r(1,i=t?o.rankings.find(l=>l.username.toLowerCase()===t):null),s.$$.dirty&4&&r(0,a=o.rankings)},[a,i,o,t,n]}class Ge extends R{constructor(e){super(),q(this,e,qe,Re,Q,{data:2})}}export{Ge as component,Ke as universal};
