import{a as H,n as q,c as fe,o as de}from"../chunks/scheduler.CbAa4uEG.js";import{S as Q,i as R,e as S,s as $,t as T,c as w,a as k,d as m,f as I,b as A,o as h,p as x,g as O,h as f,j as N,u as z,v as W,w as M,n as C,q as X,l as P,m as Y,x as K,k as ee,y as he}from"../chunks/index.8LiQRpMr.js";import{d as pe,w as te}from"../chunks/index.Cxq2KWkB.js";function re(n){return(n==null?void 0:n.length)!==void 0?n:Array.from(n)}function ge(n){if(n.__esModule)return n;var e=n.default;if(typeof e=="function"){var t=function r(){return this instanceof r?Reflect.construct(e,arguments,this.constructor):e.apply(this,arguments)};t.prototype=e.prototype}else t={};return Object.defineProperty(t,"__esModule",{value:!0}),Object.keys(n).forEach(function(r){var s=Object.getOwnPropertyDescriptor(n,r);Object.defineProperty(t,r,s.get?s:{enumerable:!0,get:function(){return n[r]}})}),t}var E={};const me={},_e=Object.freeze(Object.defineProperty({__proto__:null,default:me},Symbol.toStringTag,{value:"Module"})),ve=ge(_e);let se=ve;class ye{readFile(e,t){return se.readFileSync(e,t).toString()}writeFile(e,t){se.writeFile(t,e,function(r){if(r)throw r;console.log("File saved: "+t)})}}var be=new ye;class Se{trimPropertyName(e){return e.replace(/\s/g,"")}getValueFormatByType(e){return e===void 0||e===""?"":isNaN(e)?e==="true"||e==="false"?JSON.parse(e.toLowerCase()):String(e):Number(e)}hasContent(e){if(e.length>0){for(let t=0;t<e.length;t++)if(e[t])return!0}return!1}}var we=new Se;class ke{validateJson(e){try{JSON.parse(e)}catch(t){throw Error(`Parsed csv has generated an invalid json!!!
`+t)}}}var Ee=new ke;let ne=be,L=we,Fe=Ee;const Je=/\r?\n/,De=";";class Te{formatValueByType(e){return this.printValueFormatByType=e,this}supportQuotedField(e){return this.isSupportQuotedField=e,this}fieldDelimiter(e){return this.delimiter=e,this}indexHeader(e){if(isNaN(e))throw new Error("The index Header must be a Number!");return this.indexHeader=e,this}parseSubArray(e="*",t=","){this.parseSubArrayDelimiter=e,this.parseSubArraySeparator=t}encoding(e){return this.encoding=e,this}generateJsonFileFromCsv(e,t){let r=this.getJsonFromCsvStringified(e);ne.writeFile(r,t)}getJsonFromCsvStringified(e){let t=this.getJsonFromCsv(e),r=JSON.stringify(t,void 0,1);return Fe.validateJson(r),r}getJsonFromCsv(e){let t=ne.readFile(e,this.encoding);return this.csvToJson(t)}csvStringToJson(e){return this.csvToJson(e)}csvToJson(e){this.validateInputConfig();let t=e.split(Je),r=this.getFieldDelimiter(),s=this.getIndexHeader(),i;for(this.isSupportQuotedField?i=this.split(t[s]):i=t[s].split(r);!L.hasContent(i)&&s<=t.length;)s=s+1,i=t[s].split(r);let a=[];for(let u=s+1;u<t.length;u++){let l;this.isSupportQuotedField?l=this.split(t[u]):l=t[u].split(r),L.hasContent(l)&&a.push(this.buildJsonResult(i,l))}return a}getFieldDelimiter(){return this.delimiter?this.delimiter:De}getIndexHeader(){return this.indexHeader!==null&&!isNaN(this.indexHeader)?this.indexHeader:0}buildJsonResult(e,t){let r={};for(let s=0;s<e.length;s++){let i=L.trimPropertyName(e[s]),a=t[s];this.isParseSubArray(a)&&(a=this.buildJsonSubArray(a)),this.printValueFormatByType&&!Array.isArray(a)&&(a=L.getValueFormatByType(t[s])),r[i]=a}return r}buildJsonSubArray(e){let t=e.substring(e.indexOf(this.parseSubArrayDelimiter)+1,e.lastIndexOf(this.parseSubArrayDelimiter));if(t.trim(),e=t.split(this.parseSubArraySeparator),this.printValueFormatByType)for(let r=0;r<e.length;r++)e[r]=L.getValueFormatByType(e[r]);return e}isParseSubArray(e){return!!(this.parseSubArrayDelimiter&&e&&e.indexOf(this.parseSubArrayDelimiter)===0&&e.lastIndexOf(this.parseSubArrayDelimiter)===e.length-1)}validateInputConfig(){if(this.isSupportQuotedField){if(this.getFieldDelimiter()==='"')throw new Error('When SupportQuotedFields is enabled you cannot defined the field delimiter as quote -> ["]');if(this.parseSubArraySeparator==='"')throw new Error('When SupportQuotedFields is enabled you cannot defined the field parseSubArraySeparator as quote -> ["]');if(this.parseSubArrayDelimiter==='"')throw new Error('When SupportQuotedFields is enabled you cannot defined the field parseSubArrayDelimiter as quote -> ["]')}}hasQuotes(e){return e.includes('"')}split(e){if(e.length==0)return[];let t=this.getFieldDelimiter(),r=[""];if(this.hasQuotes(e)){let s=e.split(""),i=0,a=!1,u=!1;if(s.forEach((l,d,o)=>{if(u){r[i]+=l,u=!1;return}if(l!='"'&&l!=t)r[i]+=l;else if(l==t&&a)r[i]+=l;else if(l==t){i++,r[i]="";return}else o[d+1]==='"'?u=!0:a?a=!1:a=!0}),a)throw new Error("Row contains mismatched quotes!");return r}else return e.split(t)}}var Ae=new Te;let D=Ae;const U={utf8:"utf8",ucs2:"ucs2",utf16le:"utf16le",latin1:"latin1",ascii:"ascii",base64:"base64",hex:"hex"};E.formatValueByType=function(n=!0){return D.formatValueByType(n),this};E.supportQuotedField=function(n=!1){return D.supportQuotedField(n),this};E.fieldDelimiter=function(n){return D.fieldDelimiter(n),this};E.indexHeader=function(n){return D.indexHeader(n),this};E.parseSubArray=function(n,e){return D.parseSubArray(n,e),this};E.customEncoding=function(n){return D.encoding=n,this};E.utf8Encoding=function(){return D.encoding=U.utf8,this};E.ucs2Encoding=function(){return D.encoding=U.ucs2,this};E.utf16leEncoding=function(){return D.encoding=U.utf16le,this};E.latin1Encoding=function(){return D.encoding=U.latin1,this};E.asciiEncoding=function(){return D.encoding=U.ascii,this};E.base64Encoding=function(){return this.csvToJson=U.base64,this};E.hexEncoding=function(){return this.csvToJson=U.hex,this};E.generateJsonFileFromCsv=function(n,e){if(!n)throw new Error("inputFileName is not defined!!!");if(!e)throw new Error("outputFileName is not defined!!!");D.generateJsonFileFromCsv(n,e)};E.getJsonFromCsv=function(n){if(!n)throw new Error("inputFileName is not defined!!!");return D.getJsonFromCsv(n)};E.csvStringToJson=function(n){return D.csvStringToJson(n)};E.jsonToCsv=function(n,e){D.generateJsonFileFromCsv(n,e)};async function je(){const e=await(await fetch("https://docs.google.com/spreadsheets/d/1DVJcFkyHP3dRsJdaKjz2EwWTNBcJVrO1_Eg3A9r6Szc/export?format=csv&id=1DVJcFkyHP3dRsJdaKjz2EwWTNBcJVrO1_Eg3A9r6Szc&gid=0")).text();return E.indexHeader(1).fieldDelimiter(",").supportQuotedField(!0).formatValueByType(!0).csvStringToJson(e).map(i=>({username:i.Username,user_id:i.UserID,score_at_start:parseInt(i.ScoreatStart.replaceAll(",","")),current_score:parseInt(i.currentelim.replaceAll(",","")),gained_score:parseInt(i.currentelim.replaceAll(",",""))-parseInt(i.ScoreatStart.replaceAll(",",""))})).sort((i,a)=>a.gained_score-i.gained_score).map((i,a)=>({...i,rank:a+1}))}async function Ce({depends:n}){return n("data:rankings"),{rankings:await je()}}const Ge=Object.freeze(Object.defineProperty({__proto__:null,load:Ce},Symbol.toStringTag,{value:"Module"}));function $e(n){if(typeof window>"u"){const{subscribe:i}=te(n);return{subscribe:i}}const e=te(window.location.href),t=history.pushState,r=history.replaceState,s=()=>e.set(window.location.href);return history.pushState=function(){t.apply(this,arguments),s()},history.replaceState=function(){r.apply(this,arguments),s()},window.addEventListener("popstate",s),window.addEventListener("hashchange",s),{subscribe:pe(e,i=>new URL(i)).subscribe}}const Ie=$e();function Ve(n){let e,t,r,s,i,a=n[0].username+"",u,l,d,o,c,g=n[0].gained_score.toLocaleString("en-US")+"",_,F,J,V,v=n[0].rank+"",p;return{c(){e=S("div"),t=S("div"),r=$(),s=S("div"),i=S("p"),u=T(a),l=$(),d=S("hr"),o=$(),c=S("p"),_=T(g),F=$(),J=S("p"),V=T("#"),p=T(v),this.h()},l(b){e=w(b,"DIV",{class:!0});var y=k(e);t=w(y,"DIV",{id:!0,style:!0,class:!0}),k(t).forEach(m),r=I(y),s=w(y,"DIV",{class:!0});var j=k(s);i=w(j,"P",{id:!0,class:!0});var B=k(i);u=A(B,a),B.forEach(m),l=I(j),d=w(j,"HR",{class:!0}),o=I(j),c=w(j,"P",{id:!0,class:!0});var Z=k(c);_=A(Z,g),Z.forEach(m),j.forEach(m),F=I(y),J=w(y,"P",{id:!0,class:!0});var G=k(J);V=A(G,"#"),p=A(G,v),G.forEach(m),y.forEach(m),this.h()},h(){h(t,"id","avatar"),x(t,"background-image","url(https://a.ppy.sh/"+n[0].user_id+")"),h(t,"class","svelte-dq8yu2"),h(i,"id","username"),h(i,"class","svelte-dq8yu2"),h(d,"class","svelte-dq8yu2"),h(c,"id","gained"),h(c,"class","svelte-dq8yu2"),h(s,"class","stats svelte-dq8yu2"),h(J,"id","rank"),h(J,"class","svelte-dq8yu2"),h(e,"class","card svelte-dq8yu2")},m(b,y){O(b,e,y),f(e,t),f(e,r),f(e,s),f(s,i),f(i,u),f(s,l),f(s,d),f(s,o),f(s,c),f(c,_),f(e,F),f(e,J),f(J,V),f(J,p)},p(b,[y]){y&1&&x(t,"background-image","url(https://a.ppy.sh/"+b[0].user_id+")"),y&1&&a!==(a=b[0].username+"")&&N(u,a),y&1&&g!==(g=b[0].gained_score.toLocaleString("en-US")+"")&&N(_,g),y&1&&v!==(v=b[0].rank+"")&&N(p,v)},i:q,o:q,d(b){b&&m(e)}}}function Pe(n,e,t){let{user:r}=e;return n.$$set=s=>{"user"in s&&t(0,r=s.user)},[r]}class Ne extends Q{constructor(e){super(),R(this,e,Pe,Ve,H,{user:0})}}function Oe(n){let e,t,r,s=n[0].rank+"",i,a,u=n[0].username+"",l,d,o,c=n[0].gained_score.toLocaleString("en-US")+"",g,_,F,J=n[1].toLocaleString("en-US")+"",V;return{c(){e=S("div"),t=S("p"),r=T("#"),i=T(s),a=T(" - "),l=T(u),d=$(),o=S("p"),g=T(c),_=$(),F=S("span"),V=T(J),this.h()},l(v){e=w(v,"DIV",{class:!0});var p=k(e);t=w(p,"P",{id:!0,class:!0});var b=k(t);r=A(b,"#"),i=A(b,s),a=A(b," - "),l=A(b,u),b.forEach(m),d=I(p),o=w(p,"P",{id:!0,class:!0});var y=k(o);g=A(y,c),_=I(y),F=w(y,"SPAN",{id:!0,class:!0});var j=k(F);V=A(j,J),j.forEach(m),y.forEach(m),p.forEach(m),this.h()},h(){h(t,"id","username"),h(t,"class","svelte-8qxyyi"),h(F,"id",n[1]>0?"positive":"negative"),h(F,"class","svelte-8qxyyi"),h(o,"id","score"),h(o,"class","svelte-8qxyyi"),h(e,"class","delta svelte-8qxyyi")},m(v,p){O(v,e,p),f(e,t),f(t,r),f(t,i),f(t,a),f(t,l),f(e,d),f(e,o),f(o,g),f(o,_),f(o,F),f(F,V)},p(v,[p]){p&1&&s!==(s=v[0].rank+"")&&N(i,s),p&1&&u!==(u=v[0].username+"")&&N(l,u),p&1&&c!==(c=v[0].gained_score.toLocaleString("en-US")+"")&&N(g,c)},i:q,o:q,d(v){v&&m(e)}}}function Ue(n,e,t){let{main_user:r}=e,{compare_user:s}=e,i=s.gained_score-r.gained_score;return n.$$set=a=>{"main_user"in a&&t(2,r=a.main_user),"compare_user"in a&&t(0,s=a.compare_user)},[s,i,r]}class ce extends Q{constructor(e){super(),R(this,e,Ue,Oe,H,{main_user:2,compare_user:0})}}function ie(n){let e,t;return e=new ce({props:{main_user:n[0],compare_user:n[1][n[0].rank-2]}}),{c(){z(e.$$.fragment)},l(r){W(e.$$.fragment,r)},m(r,s){M(e,r,s),t=!0},p(r,s){const i={};s&1&&(i.main_user=r[0]),s&3&&(i.compare_user=r[1][r[0].rank-2]),e.$set(i)},i(r){t||(C(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){K(e,r)}}}function ae(n){let e;return{c(){e=S("div"),this.h()},l(t){e=w(t,"DIV",{id:!0,class:!0}),k(e).forEach(m),this.h()},h(){h(e,"id","spacer"),h(e,"class","svelte-1sj613z")},m(t,r){O(t,e,r)},d(t){t&&m(e)}}}function le(n){let e,t;return e=new ce({props:{main_user:n[0],compare_user:n[1][n[0].rank]}}),{c(){z(e.$$.fragment)},l(r){W(e.$$.fragment,r)},m(r,s){M(e,r,s),t=!0},p(r,s){const i={};s&1&&(i.main_user=r[0]),s&3&&(i.compare_user=r[1][r[0].rank]),e.$set(i)},i(r){t||(C(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){K(e,r)}}}function qe(n){let e,t,r,s,i,a,u;t=new Ne({props:{user:n[0]}});let l=n[0].rank>1&&ie(n),d=n[0].rank>1&&n[1][n[0].rank]&&ae(),o=n[1][n[0].rank]&&le(n);return{c(){e=S("div"),z(t.$$.fragment),r=$(),s=S("div"),l&&l.c(),i=$(),d&&d.c(),a=$(),o&&o.c(),this.h()},l(c){e=w(c,"DIV",{class:!0});var g=k(e);W(t.$$.fragment,g),r=I(g),s=w(g,"DIV",{class:!0});var _=k(s);l&&l.l(_),i=I(_),d&&d.l(_),a=I(_),o&&o.l(_),_.forEach(m),g.forEach(m),this.h()},h(){h(s,"class","deltas svelte-1sj613z"),h(e,"class","container svelte-1sj613z")},m(c,g){O(c,e,g),M(t,e,null),f(e,r),f(e,s),l&&l.m(s,null),f(s,i),d&&d.m(s,null),f(s,a),o&&o.m(s,null),u=!0},p(c,[g]){const _={};g&1&&(_.user=c[0]),t.$set(_),c[0].rank>1?l?(l.p(c,g),g&1&&C(l,1)):(l=ie(c),l.c(),C(l,1),l.m(s,i)):l&&(X(),P(l,1,1,()=>{l=null}),Y()),c[0].rank>1&&c[1][c[0].rank]?d||(d=ae(),d.c(),d.m(s,a)):d&&(d.d(1),d=null),c[1][c[0].rank]?o?(o.p(c,g),g&3&&C(o,1)):(o=le(c),o.c(),C(o,1),o.m(s,null)):o&&(X(),P(o,1,1,()=>{o=null}),Y())},i(c){u||(C(t.$$.fragment,c),C(l),C(o),u=!0)},o(c){P(t.$$.fragment,c),P(l),P(o),u=!1},d(c){c&&m(e),K(t),l&&l.d(),d&&d.d(),o&&o.d()}}}function Be(n,e,t){let{user:r}=e,{rankings:s}=e;return n.$$set=i=>{"user"in i&&t(0,r=i.user),"rankings"in i&&t(1,s=i.rankings)},[r,s]}class Le extends Q{constructor(e){super(),R(this,e,Be,qe,H,{user:0,rankings:1})}}function oe(n,e,t){const r=n.slice();return r[1]=e[t],r[6]=t,r}function He(n){let e,t=re(n[0]),r=[];for(let s=0;s<t.length;s+=1)r[s]=ue(oe(n,t,s));return{c(){e=S("table");for(let s=0;s<r.length;s+=1)r[s].c();this.h()},l(s){e=w(s,"TABLE",{class:!0});var i=k(e);for(let a=0;a<r.length;a+=1)r[a].l(i);i.forEach(m),this.h()},h(){h(e,"class","svelte-glvni4")},m(s,i){O(s,e,i);for(let a=0;a<r.length;a+=1)r[a]&&r[a].m(e,null)},p(s,i){if(i&1){t=re(s[0]);let a;for(a=0;a<t.length;a+=1){const u=oe(s,t,a);r[a]?r[a].p(u,i):(r[a]=ue(u),r[a].c(),r[a].m(e,null))}for(;a<r.length;a+=1)r[a].d(1);r.length=t.length}},i:q,o:q,d(s){s&&m(e),he(r,s)}}}function Qe(n){let e,t;return e=new Le({props:{user:n[1],rankings:n[0]}}),{c(){z(e.$$.fragment)},l(r){W(e.$$.fragment,r)},m(r,s){M(e,r,s),t=!0},p(r,s){const i={};s&2&&(i.user=r[1]),s&1&&(i.rankings=r[0]),e.$set(i)},i(r){t||(C(e.$$.fragment,r),t=!0)},o(r){P(e.$$.fragment,r),t=!1},d(r){K(e,r)}}}function ue(n){let e,t,r,s=n[6]+1+"",i,a,u,l,d=n[1].username+"",o,c,g,_,F=n[1].gained_score.toLocaleString()+"",J,V;return{c(){e=S("tr"),t=S("td"),r=T("#"),i=T(s),a=$(),u=S("td"),l=S("a"),o=T(d),g=$(),_=S("td"),J=T(F),V=$(),this.h()},l(v){e=w(v,"TR",{class:!0});var p=k(e);t=w(p,"TD",{class:!0});var b=k(t);r=A(b,"#"),i=A(b,s),b.forEach(m),a=I(p),u=w(p,"TD",{class:!0});var y=k(u);l=w(y,"A",{href:!0,class:!0});var j=k(l);o=A(j,d),j.forEach(m),y.forEach(m),g=I(p),_=w(p,"TD",{class:!0});var B=k(_);J=A(B,F),B.forEach(m),V=I(p),p.forEach(m),this.h()},h(){h(t,"class","rank svelte-glvni4"),h(l,"href",c="#"+n[1].username),h(l,"class","svelte-glvni4"),h(u,"class","user svelte-glvni4"),h(_,"class","score svelte-glvni4"),h(e,"class","svelte-glvni4")},m(v,p){O(v,e,p),f(e,t),f(t,r),f(t,i),f(e,a),f(e,u),f(u,l),f(l,o),f(e,g),f(e,_),f(_,J),f(e,V)},p(v,p){p&1&&d!==(d=v[1].username+"")&&N(o,d),p&1&&c!==(c="#"+v[1].username)&&h(l,"href",c),p&1&&F!==(F=v[1].gained_score.toLocaleString()+"")&&N(J,F)},d(v){v&&m(e)}}}function Re(n){let e,t,r,s;const i=[Qe,He],a=[];function u(l,d){return l[1]?0:1}return e=u(n),t=a[e]=i[e](n),{c(){t.c(),r=ee()},l(l){t.l(l),r=ee()},m(l,d){a[e].m(l,d),O(l,r,d),s=!0},p(l,[d]){let o=e;e=u(l),e===o?a[e].p(l,d):(X(),P(a[o],1,1,()=>{a[o]=null}),Y(),t=a[e],t?t.p(l,d):(t=a[e]=i[e](l),t.c()),C(t,1),t.m(r.parentNode,r))},i(l){s||(C(t),s=!0)},o(l){P(t),s=!1},d(l){l&&m(r),a[e].d(l)}}}function ze(n,e,t){let r,s,i,a;fe(n,Ie,l=>t(4,a=l));let{data:u}=e;return de(()=>{const l=setInterval(()=>{invalidate("data:rankings")},3e5);return()=>{clearInterval(l)}}),n.$$set=l=>{"data"in l&&t(2,u=l.data)},n.$$.update=()=>{n.$$.dirty&16&&t(3,r=decodeURIComponent(a.hash.substring(1).toLowerCase())),n.$$.dirty&12&&t(1,s=r?u.rankings.find(l=>l.username.toLowerCase()===r):null),n.$$.dirty&4&&t(0,i=u.rankings)},[i,s,u,r,a]}class Xe extends Q{constructor(e){super(),R(this,e,ze,Re,H,{data:2})}}export{Xe as component,Ge as universal};
